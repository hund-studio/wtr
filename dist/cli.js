#!/usr/bin/env node

(()=>{"use strict";var e={81:e=>{e.exports=require("child_process")}},t={};function r(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{require("dotenv/config");const e=require("fs"),t=require("cli-loading-animation"),s=require("webpack-merge"),n=require("path");var o=r(81);const i=require("tsconfig-paths-webpack-plugin"),a=require("webpack"),l=require("app-root-path");var p=r.n(l);const c=require("chalk");var u=r.n(c);const d=require("cli-spinners");var g=r.n(d);const h=require("mini-css-extract-plugin");var m=r.n(h);const v=require("webpack-dev-server");var w=r.n(v);const f=e=>{x.stop&&x.stop();const{start:r,stop:s}=(0,t.loading)(u().magenta((e=>{switch(e){case"initialization":return"Setting up boilerplate...";case"configuration":return"Installing required packages...";case"compilation":return"Generating WP compiler...";case"serving":return"Server started at http://localhost:9000 ...";case"bundling":return"Generating WP assets...";case"waiting":return"Waiting for file changes..."}})(e)),{clearOnEnd:!0,spinner:g().dots});x.current=e,x.start=r,x.stop=s,x.start()},b=()=>{x.stop&&x.stop()},x={current:null,trigger:f,terminate:b};if("init"===process.argv[2]){f("initialization"),(0,e.cpSync)((0,n.resolve)(p().path,"node_modules/@hund-ernesto/wtr/init"),(0,n.resolve)(process.cwd(),"website"),{recursive:!0}),process.chdir((0,n.resolve)(process.cwd(),"website")),f("configuration");const{spawnSync:t}=r(81);0===t("npm",["install"],{stdio:"inherit"}).status?0===t("npm",["run","build"],{stdio:"inherit"}).status?(b(),console.log(u().blue("Initialization completed, you are ready to go!")),process.exit()):(console.error("Error running npm run build"),process.exit(1)):(console.error("Error running npm install"),process.exit(1))}const y=process.env.WP_HOST;if(!y)throw new Error("undefined-env-wp_host");const O="start"===process.argv[2],_=O||"dev"===process.argv[2],P={mode:_?"development":"production",devtool:_?"inline-source-map":"source-map",module:{rules:[{test:/\.tsx?$/,use:[{loader:"ts-loader",options:{transpileOnly:!0}}],exclude:/node_modules\/(?!@hund-ernesto\/wtr)/},{test:/\.scss$/,use:[m().loader,"css-loader","sass-loader"]},{test:/\.(png|svg|jpg|jpeg|gif)$/i,type:"asset/resource",generator:{filename:"assets/images/[name][ext]"}},{test:/\.(woff|woff2|eot|ttf|otf)$/i,type:"asset/resource",generator:{filename:"assets/fonts/[name][ext]"}}]},resolve:{extensions:["",".tsx",".ts",".js",".jsx",".css",".scss"],modules:["node_modules"],alias:{"@":p().path},plugins:[new i.TsconfigPathsPlugin({configFile:(0,n.resolve)(p().path,"tsconfig.json"),extensions:[".ts",".js"]})]},plugins:[new a.DefinePlugin({MODE:JSON.stringify(O?"serve":_?"watch":"build"),PROJECT:JSON.stringify(p().path),CORE_WP:JSON.stringify((0,n.resolve)(p().path,"node_modules/@hund-ernesto/wtr")),WP_HOST:JSON.stringify(y)}),new(m())({})],output:{publicPath:"/wp-content/themes/wp-theme/dist/"},optimization:{splitChunks:{cacheGroups:{styles:{name:"main",type:"css/mini-extract",chunks:"all",enforce:!0}}}}},k=(e,t)=>{if(e||t?.hasErrors())return x.terminate(),void console.error(u().red("WP Compiler bundle failed due to an unknown error"))},q=(0,a.webpack)((0,s.merge)(P,{target:"web",entry:{main:(0,n.resolve)(p().path,"node_modules/@hund-ernesto/wtr/src/bundle.tsx")},output:{filename:"[name].js",path:(0,n.resolve)(p().path,"_out/wp-theme/dist"),clean:!0,publicPath:O?"/":void 0},infrastructureLogging:{level:"error"},stats:"none"})),S=new(w())({static:[(0,n.resolve)(p().path,"node_modules/@hund-ernesto/wtr/server"),(0,n.resolve)(p().path,"_out/wp-theme/dist")],compress:!0,port:9e3,historyApiFallback:!0},q),j=(0,a.webpack)((0,s.merge)(P,{target:"node",entry:{index:(0,n.resolve)(p().path,"node_modules/@hund-ernesto/wtr/src/compiler.tsx")},output:{filename:"[name].js",path:(0,n.resolve)(p().path,".compiler"),clean:!0}}));x.trigger("compilation"),O?(x.trigger("serving"),S.start()):_?j.watch({},k):j.run(k),j.hooks.done.tap("DoneMessage",(async e=>{x.stop?.(),await new Promise(((e,t)=>{const r=(0,n.resolve)(p().path,"./.compiler/index.js"),s=(0,o.spawn)("node",[r]);let i=[];s.stdout.on("data",(e=>{if(e){const t=e.toString().trim();i.push(u().white(t))}})),s.stderr.on("data",(e=>{if(e){const t=e.toString().trim();i.push(u().red(t))}})),s.on("close",(r=>{i.length?i=[u().green("✓ Application rendered the following LOGS"),...i,u().green("↥ Application LOG END")]:i.push(u().green("✓ Application rendered without LOGS")),console.log(i.join("\n")),0===r?e():t(`Compilation failed with exit code ${r}`)}))})),x.trigger("bundling"),q.run(k),q.hooks.done.tap("DoneMessage",(async e=>{x.stop?.(),_?x.trigger("waiting"):console.log(u().green("✓ Compilation completed, you are ready to go!"))}))}))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RixHQUFlLElBQUFDLE9BQU0sT0FBUSxDQUFDRixJQUNwQyxJQUFJRyxFQUEyQixHQUUvQkYsRUFBYUcsT0FBT0MsR0FBRyxRQUFTQyxJQUMvQixHQUFJQSxFQUFNLENBQ1QsTUFBTUMsRUFBY0QsRUFBS0UsV0FBV0MsT0FDcENOLEVBQWVPLEtBQUssVUFBWUgsR0FDakMsS0FHRE4sRUFBYVUsT0FBT04sR0FBRyxRQUFTQyxJQUMvQixHQUFJQSxFQUFNLENBQ1QsTUFBTUMsRUFBY0QsRUFBS0UsV0FBV0MsT0FDcENOLEVBQWVPLEtBQUssUUFBVUgsR0FDL0IsS0FHRE4sRUFBYUksR0FBRyxTQUFVTyxJQUNuQlQsRUFBdUIsT0FDNUJBLEVBQWlCLENBQ2hCLFVBQVksZ0RBQ1RBLEVBQ0gsVUFBWSwwQkFHYkEsRUFBZU8sS0FBSyxVQUFZLHdDQUdqQ25GLFFBQVFDLElBQUkyRSxFQUFlVSxLQUFLLE9BRW5CLElBQVRELEVBQ0hkLElBRUFDLEVBQVEscUNBQXFDYSxJQUM5QyxHQUNDLElBd0JGMUcsRUFBS1MsUUFBUSxZQUNiMkQsRUFBT2tCLElBQUl0QixHQUVYSSxFQUFPbUIsTUFBTUMsS0FBS0MsSUFBSSxlQUFlQyxNQUFPeEIsSUFDM0NsRSxFQUFLQyxTQUVENEIsRUFDSDdCLEVBQUtTLFFBQVEsV0FFYlksUUFBUUMsSUFBSSxVQUFZLGlEQUN6QixHQUNDLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AaHVuZC1lcm5lc3RvL3d0ci9leHRlcm5hbCBub2RlLWNvbW1vbmpzIFwiY2hpbGRfcHJvY2Vzc1wiIiwid2VicGFjazovL0BodW5kLWVybmVzdG8vd3RyL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0BodW5kLWVybmVzdG8vd3RyL3dlYnBhY2svcnVudGltZS9jb21wYXQgZ2V0IGRlZmF1bHQgZXhwb3J0Iiwid2VicGFjazovL0BodW5kLWVybmVzdG8vd3RyL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9AaHVuZC1lcm5lc3RvL3d0ci93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL0BodW5kLWVybmVzdG8vd3RyL2V4dGVybmFsIGNvbW1vbmpzIFwiZG90ZW52L2NvbmZpZ1wiIiwid2VicGFjazovL0BodW5kLWVybmVzdG8vd3RyL2V4dGVybmFsIG5vZGUtY29tbW9uanMgXCJmc1wiIiwid2VicGFjazovL0BodW5kLWVybmVzdG8vd3RyL2V4dGVybmFsIGNvbW1vbmpzIFwiY2xpLWxvYWRpbmctYW5pbWF0aW9uXCIiLCJ3ZWJwYWNrOi8vQGh1bmQtZXJuZXN0by93dHIvZXh0ZXJuYWwgY29tbW9uanMgXCJ3ZWJwYWNrLW1lcmdlXCIiLCJ3ZWJwYWNrOi8vQGh1bmQtZXJuZXN0by93dHIvZXh0ZXJuYWwgbm9kZS1jb21tb25qcyBcInBhdGhcIiIsIndlYnBhY2s6Ly9AaHVuZC1lcm5lc3RvL3d0ci9leHRlcm5hbCBjb21tb25qcyBcInRzY29uZmlnLXBhdGhzLXdlYnBhY2stcGx1Z2luXCIiLCJ3ZWJwYWNrOi8vQGh1bmQtZXJuZXN0by93dHIvZXh0ZXJuYWwgY29tbW9uanMgXCJ3ZWJwYWNrXCIiLCJ3ZWJwYWNrOi8vQGh1bmQtZXJuZXN0by93dHIvZXh0ZXJuYWwgY29tbW9uanMgXCJhcHAtcm9vdC1wYXRoXCIiLCJ3ZWJwYWNrOi8vQGh1bmQtZXJuZXN0by93dHIvZXh0ZXJuYWwgY29tbW9uanMgXCJjaGFsa1wiIiwid2VicGFjazovL0BodW5kLWVybmVzdG8vd3RyL2V4dGVybmFsIGNvbW1vbmpzIFwiY2xpLXNwaW5uZXJzXCIiLCJ3ZWJwYWNrOi8vQGh1bmQtZXJuZXN0by93dHIvZXh0ZXJuYWwgY29tbW9uanMgXCJtaW5pLWNzcy1leHRyYWN0LXBsdWdpblwiIiwid2VicGFjazovL0BodW5kLWVybmVzdG8vd3RyL2V4dGVybmFsIGNvbW1vbmpzIFwid2VicGFjay1kZXYtc2VydmVyXCIiLCJ3ZWJwYWNrOi8vQGh1bmQtZXJuZXN0by93dHIvLi9zcmMvY2xpLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImNoaWxkX3Byb2Nlc3NcIik7IiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSAobW9kdWxlKSA9PiB7XG5cdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuXHRcdCgpID0+IChtb2R1bGVbJ2RlZmF1bHQnXSkgOlxuXHRcdCgpID0+IChtb2R1bGUpO1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCB7IGE6IGdldHRlciB9KTtcblx0cmV0dXJuIGdldHRlcjtcbn07IiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsImNvbnN0IF9fV0VCUEFDS19OQU1FU1BBQ0VfT0JKRUNUX18gPSByZXF1aXJlKFwiZG90ZW52L2NvbmZpZ1wiKTsiLCJjb25zdCBfX1dFQlBBQ0tfTkFNRVNQQUNFX09CSkVDVF9fID0gcmVxdWlyZShcImZzXCIpOyIsImNvbnN0IF9fV0VCUEFDS19OQU1FU1BBQ0VfT0JKRUNUX18gPSByZXF1aXJlKFwiY2xpLWxvYWRpbmctYW5pbWF0aW9uXCIpOyIsImNvbnN0IF9fV0VCUEFDS19OQU1FU1BBQ0VfT0JKRUNUX18gPSByZXF1aXJlKFwid2VicGFjay1tZXJnZVwiKTsiLCJjb25zdCBfX1dFQlBBQ0tfTkFNRVNQQUNFX09CSkVDVF9fID0gcmVxdWlyZShcInBhdGhcIik7IiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IHJlcXVpcmUoXCJ0c2NvbmZpZy1wYXRocy13ZWJwYWNrLXBsdWdpblwiKTsiLCJjb25zdCBfX1dFQlBBQ0tfTkFNRVNQQUNFX09CSkVDVF9fID0gcmVxdWlyZShcIndlYnBhY2tcIik7IiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IHJlcXVpcmUoXCJhcHAtcm9vdC1wYXRoXCIpOyIsImNvbnN0IF9fV0VCUEFDS19OQU1FU1BBQ0VfT0JKRUNUX18gPSByZXF1aXJlKFwiY2hhbGtcIik7IiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IHJlcXVpcmUoXCJjbGktc3Bpbm5lcnNcIik7IiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IHJlcXVpcmUoXCJtaW5pLWNzcy1leHRyYWN0LXBsdWdpblwiKTsiLCJjb25zdCBfX1dFQlBBQ0tfTkFNRVNQQUNFX09CSkVDVF9fID0gcmVxdWlyZShcIndlYnBhY2stZGV2LXNlcnZlclwiKTsiLCJpbXBvcnQgXCJkb3RlbnYvY29uZmlnXCI7XG5pbXBvcnQgeyBjcFN5bmMgfSBmcm9tIFwiZnNcIjtcbmltcG9ydCB7IExvYWRlckFjdGlvbnMsIGxvYWRpbmcgfSBmcm9tIFwiY2xpLWxvYWRpbmctYW5pbWF0aW9uXCI7XG5pbXBvcnQgeyBtZXJnZSB9IGZyb20gXCJ3ZWJwYWNrLW1lcmdlXCI7XG5pbXBvcnQgeyByZXNvbHZlIH0gZnJvbSBcInBhdGhcIjtcbmltcG9ydCB7IHNwYXduIH0gZnJvbSBcImNoaWxkX3Byb2Nlc3NcIjtcbmltcG9ydCB7IFRzY29uZmlnUGF0aHNQbHVnaW4gfSBmcm9tIFwidHNjb25maWctcGF0aHMtd2VicGFjay1wbHVnaW5cIjtcbmltcG9ydCB7IHdlYnBhY2ssIERlZmluZVBsdWdpbiwgQ29uZmlndXJhdGlvbiwgU3RhdHMgfSBmcm9tIFwid2VicGFja1wiO1xuaW1wb3J0IGFwcFJvb3QgZnJvbSBcImFwcC1yb290LXBhdGhcIjtcbmltcG9ydCBjaGFsayBmcm9tIFwiY2hhbGtcIjtcbmltcG9ydCBjbGlTcGlubmVycyBmcm9tIFwiY2xpLXNwaW5uZXJzXCI7XG5pbXBvcnQgTWluaUNzc0V4dHJhY3RQbHVnaW4gZnJvbSBcIm1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXCI7XG5pbXBvcnQgV2VicGFja0RldlNlcnZlciBmcm9tIFwid2VicGFjay1kZXYtc2VydmVyXCI7XG5pbXBvcnQgXCJ3ZWJwYWNrLWRldi1zZXJ2ZXJcIjtcblxuLyoqXG4gKiBIYW5kbGUgQ0xJIHN0ZXBzIHZpc3VhbGl6YXRpb25cbiAqL1xuXG5pbnRlcmZhY2UgSVN0ZXAgZXh0ZW5kcyBQYXJ0aWFsPExvYWRlckFjdGlvbnM+IHtcblx0Y3VycmVudDogc3RyaW5nIHwgbnVsbDtcblx0dHJpZ2dlcjogdHlwZW9mIHRyaWdnZXJTdGVwO1xuXHR0ZXJtaW5hdGU6IHR5cGVvZiB0ZXJtaW5hdGVTdGVwO1xufVxuXG50eXBlIFN0ZXBLZXkgPVxuXHR8IFwiY29uZmlndXJhdGlvblwiXG5cdHwgXCJpbml0aWFsaXphdGlvblwiXG5cdHwgXCJjb21waWxhdGlvblwiXG5cdHwgXCJidW5kbGluZ1wiXG5cdHwgXCJ3YWl0aW5nXCJcblx0fCBcInNlcnZpbmdcIjtcblxuY29uc3QgZ2V0U3RlcE1lc3NhZ2UgPSAoa2V5OiBTdGVwS2V5KSA9PiB7XG5cdHN3aXRjaCAoa2V5KSB7XG5cdFx0Y2FzZSBcImluaXRpYWxpemF0aW9uXCI6XG5cdFx0XHRyZXR1cm4gXCJTZXR0aW5nIHVwIGJvaWxlcnBsYXRlLi4uXCI7XG5cdFx0Y2FzZSBcImNvbmZpZ3VyYXRpb25cIjpcblx0XHRcdHJldHVybiBcIkluc3RhbGxpbmcgcmVxdWlyZWQgcGFja2FnZXMuLi5cIjtcblx0XHRjYXNlIFwiY29tcGlsYXRpb25cIjpcblx0XHRcdHJldHVybiBcIkdlbmVyYXRpbmcgV1AgY29tcGlsZXIuLi5cIjtcblx0XHRjYXNlIFwic2VydmluZ1wiOlxuXHRcdFx0cmV0dXJuIFwiU2VydmVyIHN0YXJ0ZWQgYXQgaHR0cDovL2xvY2FsaG9zdDo5MDAwIC4uLlwiO1xuXHRcdGNhc2UgXCJidW5kbGluZ1wiOlxuXHRcdFx0cmV0dXJuIFwiR2VuZXJhdGluZyBXUCBhc3NldHMuLi5cIjtcblx0XHRjYXNlIFwid2FpdGluZ1wiOlxuXHRcdFx0cmV0dXJuIFwiV2FpdGluZyBmb3IgZmlsZSBjaGFuZ2VzLi4uXCI7XG5cdH1cbn07XG5cbmNvbnN0IHRyaWdnZXJTdGVwID0gKGtleTogU3RlcEtleSkgPT4ge1xuXHRpZiAoISFzdGVwW1wic3RvcFwiXSkge1xuXHRcdHN0ZXAuc3RvcCgpO1xuXHR9XG5cblx0Y29uc3QgeyBzdGFydCwgc3RvcCB9ID0gbG9hZGluZyhjaGFsay5tYWdlbnRhKGdldFN0ZXBNZXNzYWdlKGtleSkpLCB7XG5cdFx0Y2xlYXJPbkVuZDogdHJ1ZSxcblx0XHRzcGlubmVyOiBjbGlTcGlubmVyc1tcImRvdHNcIl0sXG5cdH0pO1xuXHRzdGVwLmN1cnJlbnQgPSBrZXk7XG5cdHN0ZXAuc3RhcnQgPSBzdGFydDtcblx0c3RlcC5zdG9wID0gc3RvcDtcblxuXHRzdGVwLnN0YXJ0KCk7XG59O1xuXG5jb25zdCB0ZXJtaW5hdGVTdGVwID0gKCkgPT4ge1xuXHRpZiAoISFzdGVwW1wic3RvcFwiXSkge1xuXHRcdHN0ZXAuc3RvcCgpO1xuXHR9XG59O1xuXG5jb25zdCBzdGVwOiBJU3RlcCA9IHtcblx0Y3VycmVudDogbnVsbCxcblx0dHJpZ2dlcjogdHJpZ2dlclN0ZXAsXG5cdHRlcm1pbmF0ZTogdGVybWluYXRlU3RlcCxcbn07XG5cbi8qKlxuICogSW5pdGlhbGl6YXRpb24gc2NyaXB0XG4gKi9cblxuY29uc3QgaXNJbml0ID0gcHJvY2Vzcy5hcmd2WzJdID09PSBcImluaXRcIjtcblxuaWYgKGlzSW5pdCkge1xuXHR0cmlnZ2VyU3RlcChcImluaXRpYWxpemF0aW9uXCIpO1xuXG5cdGNwU3luYyhcblx0XHRyZXNvbHZlKGFwcFJvb3RbXCJwYXRoXCJdLCBcIm5vZGVfbW9kdWxlcy9AaHVuZC1lcm5lc3RvL3d0ci9pbml0XCIpLFxuXHRcdHJlc29sdmUocHJvY2Vzcy5jd2QoKSwgXCJ3ZWJzaXRlXCIpLFxuXHRcdHtcblx0XHRcdHJlY3Vyc2l2ZTogdHJ1ZSxcblx0XHR9XG5cdCk7XG5cblx0cHJvY2Vzcy5jaGRpcihyZXNvbHZlKHByb2Nlc3MuY3dkKCksIFwid2Vic2l0ZVwiKSk7XG5cblx0dHJpZ2dlclN0ZXAoXCJjb25maWd1cmF0aW9uXCIpO1xuXHRjb25zdCB7IHNwYXduU3luYyB9ID0gcmVxdWlyZShcImNoaWxkX3Byb2Nlc3NcIik7XG5cdGNvbnN0IG5wbUluc3RhbGwgPSBzcGF3blN5bmMoXCJucG1cIiwgW1wiaW5zdGFsbFwiXSwgeyBzdGRpbzogXCJpbmhlcml0XCIgfSk7XG5cblx0aWYgKG5wbUluc3RhbGwuc3RhdHVzID09PSAwKSB7XG5cdFx0Y29uc3QgbnBtQnVpbGQgPSBzcGF3blN5bmMoXCJucG1cIiwgW1wicnVuXCIsIFwiYnVpbGRcIl0sIHsgc3RkaW86IFwiaW5oZXJpdFwiIH0pO1xuXG5cdFx0aWYgKG5wbUJ1aWxkLnN0YXR1cyA9PT0gMCkge1xuXHRcdFx0dGVybWluYXRlU3RlcCgpO1xuXHRcdFx0Y29uc29sZS5sb2coY2hhbGsuYmx1ZShcIkluaXRpYWxpemF0aW9uIGNvbXBsZXRlZCwgeW91IGFyZSByZWFkeSB0byBnbyFcIikpO1xuXHRcdFx0cHJvY2Vzcy5leGl0KCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoXCJFcnJvciBydW5uaW5nIG5wbSBydW4gYnVpbGRcIik7XG5cdFx0XHRwcm9jZXNzLmV4aXQoMSk7XG5cdFx0fVxuXHR9IGVsc2Uge1xuXHRcdGNvbnNvbGUuZXJyb3IoXCJFcnJvciBydW5uaW5nIG5wbSBpbnN0YWxsXCIpO1xuXHRcdHByb2Nlc3MuZXhpdCgxKTtcblx0fVxufVxuXG4vKipcbiAqIE9wdGlvbnNcbiAqL1xuXG5jb25zdCBXUF9IT1NUID0gcHJvY2Vzcy5lbnYuV1BfSE9TVDtcblxuaWYgKCFXUF9IT1NUKSB7XG5cdHRocm93IG5ldyBFcnJvcihcInVuZGVmaW5lZC1lbnYtd3BfaG9zdFwiKTsgLy8gVE9ETyBFcnJvciBkaXNwbGF5XG59XG5cbmNvbnN0IGlzU2VydmUgPSBwcm9jZXNzLmFyZ3ZbMl0gPT09IFwic3RhcnRcIjtcbmNvbnN0IGlzRGV2ID0gaXNTZXJ2ZSB8fCBwcm9jZXNzLmFyZ3ZbMl0gPT09IFwiZGV2XCI7XG5cbi8qKlxuICogV2VicGFjayBnbG9iYWwgY29uZmlndXJhdGlvblxuICovXG5jb25zdCBjb25maWd1cmF0aW9uOiBDb25maWd1cmF0aW9uID0ge1xuXHRtb2RlOiBpc0RldiA/IFwiZGV2ZWxvcG1lbnRcIiA6IFwicHJvZHVjdGlvblwiLFxuXHRkZXZ0b29sOiBpc0RldiA/IFwiaW5saW5lLXNvdXJjZS1tYXBcIiA6IFwic291cmNlLW1hcFwiLFxuXHRtb2R1bGU6IHtcblx0XHRydWxlczogW1xuXHRcdFx0e1xuXHRcdFx0XHR0ZXN0OiAvXFwudHN4PyQvLFxuXHRcdFx0XHR1c2U6IFtcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRsb2FkZXI6IFwidHMtbG9hZGVyXCIsXG5cdFx0XHRcdFx0XHRvcHRpb25zOiB7XG5cdFx0XHRcdFx0XHRcdHRyYW5zcGlsZU9ubHk6IHRydWUsXG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdF0sXG5cdFx0XHRcdGV4Y2x1ZGU6IC9ub2RlX21vZHVsZXNcXC8oPyFAaHVuZC1lcm5lc3RvXFwvd3RyKS8sXG5cdFx0XHR9LFxuXHRcdFx0e1xuXHRcdFx0XHR0ZXN0OiAvXFwuc2NzcyQvLFxuXHRcdFx0XHR1c2U6IFtNaW5pQ3NzRXh0cmFjdFBsdWdpbi5sb2FkZXIsIFwiY3NzLWxvYWRlclwiLCBcInNhc3MtbG9hZGVyXCJdLFxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0dGVzdDogL1xcLihwbmd8c3ZnfGpwZ3xqcGVnfGdpZikkL2ksXG5cdFx0XHRcdHR5cGU6IFwiYXNzZXQvcmVzb3VyY2VcIixcblx0XHRcdFx0Z2VuZXJhdG9yOiB7XG5cdFx0XHRcdFx0ZmlsZW5hbWU6IFwiYXNzZXRzL2ltYWdlcy9bbmFtZV1bZXh0XVwiLFxuXHRcdFx0XHR9LFxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0dGVzdDogL1xcLih3b2ZmfHdvZmYyfGVvdHx0dGZ8b3RmKSQvaSxcblx0XHRcdFx0dHlwZTogXCJhc3NldC9yZXNvdXJjZVwiLFxuXHRcdFx0XHRnZW5lcmF0b3I6IHtcblx0XHRcdFx0XHRmaWxlbmFtZTogXCJhc3NldHMvZm9udHMvW25hbWVdW2V4dF1cIixcblx0XHRcdFx0fSxcblx0XHRcdH0sXG5cdFx0XSxcblx0fSxcblx0cmVzb2x2ZToge1xuXHRcdGV4dGVuc2lvbnM6IFtcIlwiLCBcIi50c3hcIiwgXCIudHNcIiwgXCIuanNcIiwgXCIuanN4XCIsIFwiLmNzc1wiLCBcIi5zY3NzXCJdLFxuXHRcdG1vZHVsZXM6IFtcIm5vZGVfbW9kdWxlc1wiXSxcblx0XHRhbGlhczoge1xuXHRcdFx0XCJAXCI6IGFwcFJvb3RbXCJwYXRoXCJdLFxuXHRcdH0sXG5cdFx0cGx1Z2luczogW1xuXHRcdFx0bmV3IFRzY29uZmlnUGF0aHNQbHVnaW4oe1xuXHRcdFx0XHRjb25maWdGaWxlOiByZXNvbHZlKGFwcFJvb3RbXCJwYXRoXCJdLCBcInRzY29uZmlnLmpzb25cIiksXG5cdFx0XHRcdGV4dGVuc2lvbnM6IFtcIi50c1wiLCBcIi5qc1wiXSxcblx0XHRcdH0pLFxuXHRcdF0sIC8vIFRPRE8gZXZhbHVhdGUgaWYgbmVlZGVkXG5cdH0sXG5cdHBsdWdpbnM6IFtcblx0XHRuZXcgRGVmaW5lUGx1Z2luKHtcblx0XHRcdE1PREU6IEpTT04uc3RyaW5naWZ5KGlzU2VydmUgPyBcInNlcnZlXCIgOiBpc0RldiA/IFwid2F0Y2hcIiA6IFwiYnVpbGRcIiksXG5cdFx0XHRQUk9KRUNUOiBKU09OLnN0cmluZ2lmeShhcHBSb290W1wicGF0aFwiXSksXG5cdFx0XHRDT1JFX1dQOiBKU09OLnN0cmluZ2lmeShyZXNvbHZlKGFwcFJvb3RbXCJwYXRoXCJdLCBcIm5vZGVfbW9kdWxlcy9AaHVuZC1lcm5lc3RvL3d0clwiKSksXG5cdFx0XHRXUF9IT1NUOiBKU09OLnN0cmluZ2lmeShXUF9IT1NUKSxcblx0XHR9KSxcblx0XHRuZXcgTWluaUNzc0V4dHJhY3RQbHVnaW4oe30pLFxuXHRdLFxuXHRvdXRwdXQ6IHtcblx0XHRwdWJsaWNQYXRoOiBcIi93cC1jb250ZW50L3RoZW1lcy93cC10aGVtZS9kaXN0L1wiLFxuXHR9LFxuXHRvcHRpbWl6YXRpb246IHtcblx0XHRzcGxpdENodW5rczoge1xuXHRcdFx0Y2FjaGVHcm91cHM6IHtcblx0XHRcdFx0c3R5bGVzOiB7XG5cdFx0XHRcdFx0bmFtZTogXCJtYWluXCIsXG5cdFx0XHRcdFx0dHlwZTogXCJjc3MvbWluaS1leHRyYWN0XCIsXG5cdFx0XHRcdFx0Y2h1bmtzOiBcImFsbFwiLFxuXHRcdFx0XHRcdGVuZm9yY2U6IHRydWUsXG5cdFx0XHRcdH0sXG5cdFx0XHR9LFxuXHRcdH0sXG5cdH0sXG59O1xuXG5jb25zdCB3ZWJwYWNrRXJyb3JIYW5kbGVyID0gKGVycjogRXJyb3IgfCBudWxsIHwgdW5kZWZpbmVkLCBzdGF0czogU3RhdHMgfCB1bmRlZmluZWQpID0+IHtcblx0aWYgKGVyciB8fCBzdGF0cz8uaGFzRXJyb3JzKCkpIHtcblx0XHRzdGVwLnRlcm1pbmF0ZSgpO1xuXHRcdGNvbnNvbGUuZXJyb3IoY2hhbGsucmVkKFwiV1AgQ29tcGlsZXIgYnVuZGxlIGZhaWxlZCBkdWUgdG8gYW4gdW5rbm93biBlcnJvclwiKSk7XG5cdFx0cmV0dXJuO1xuXHR9XG59O1xuXG4vKipcbiAqIFdlYnBhY2sgYnVuZGxlIGdlbmVyYXRvclxuICovXG5cbmNvbnN0IGJ1bmRsZSA9IHdlYnBhY2soXG5cdG1lcmdlKGNvbmZpZ3VyYXRpb24sIHtcblx0XHR0YXJnZXQ6IFwid2ViXCIsXG5cdFx0ZW50cnk6IHsgbWFpbjogcmVzb2x2ZShhcHBSb290W1wicGF0aFwiXSwgXCJub2RlX21vZHVsZXMvQGh1bmQtZXJuZXN0by93dHIvc3JjL2J1bmRsZS50c3hcIikgfSxcblx0XHRvdXRwdXQ6IHtcblx0XHRcdGZpbGVuYW1lOiBcIltuYW1lXS5qc1wiLFxuXHRcdFx0cGF0aDogcmVzb2x2ZShhcHBSb290W1wicGF0aFwiXSwgXCJfb3V0L3dwLXRoZW1lL2Rpc3RcIiksXG5cdFx0XHRjbGVhbjogdHJ1ZSxcblx0XHRcdHB1YmxpY1BhdGg6IGlzU2VydmUgPyBcIi9cIiA6IHVuZGVmaW5lZCxcblx0XHR9LFxuXHRcdGluZnJhc3RydWN0dXJlTG9nZ2luZzogeyBsZXZlbDogXCJlcnJvclwiIH0sXG5cdFx0c3RhdHM6IFwibm9uZVwiLFxuXHR9KVxuKTtcblxuLyoqXG4gKiBXZWJwYWNrIHNlcnZlclxuICovXG5cbmNvbnN0IHNlcnZlciA9IG5ldyBXZWJwYWNrRGV2U2VydmVyKFxuXHR7XG5cdFx0c3RhdGljOiBbXG5cdFx0XHRyZXNvbHZlKGFwcFJvb3RbXCJwYXRoXCJdLCBcIm5vZGVfbW9kdWxlcy9AaHVuZC1lcm5lc3RvL3d0ci9zZXJ2ZXJcIiksXG5cdFx0XHRyZXNvbHZlKGFwcFJvb3RbXCJwYXRoXCJdLCBcIl9vdXQvd3AtdGhlbWUvZGlzdFwiKSxcblx0XHRdLFxuXHRcdGNvbXByZXNzOiB0cnVlLFxuXHRcdHBvcnQ6IDkwMDAsXG5cdFx0aGlzdG9yeUFwaUZhbGxiYWNrOiB0cnVlLFxuXHR9LFxuXHRidW5kbGVcbik7XG5cbi8qKlxuICogV2VicGFjayBjb21waWxlciBnZW5lcmF0b3JcbiAqL1xuXG5jb25zdCBjb21waWxlciA9IHdlYnBhY2soXG5cdG1lcmdlKGNvbmZpZ3VyYXRpb24sIHtcblx0XHR0YXJnZXQ6IFwibm9kZVwiLFxuXHRcdGVudHJ5OiB7XG5cdFx0XHRpbmRleDogcmVzb2x2ZShhcHBSb290W1wicGF0aFwiXSwgXCJub2RlX21vZHVsZXMvQGh1bmQtZXJuZXN0by93dHIvc3JjL2NvbXBpbGVyLnRzeFwiKSxcblx0XHR9LFxuXHRcdG91dHB1dDoge1xuXHRcdFx0ZmlsZW5hbWU6IFwiW25hbWVdLmpzXCIsXG5cdFx0XHRwYXRoOiByZXNvbHZlKGFwcFJvb3RbXCJwYXRoXCJdLCBcIi5jb21waWxlclwiKSxcblx0XHRcdGNsZWFuOiB0cnVlLFxuXHRcdH0sXG5cdH0pXG4pO1xuXG5jb25zdCBydW5Db21waWxlciA9ICgpID0+XG5cdG5ldyBQcm9taXNlPHZvaWQ+KChfcmVzb2x2ZSwgX3JlamVjdCkgPT4ge1xuXHRcdGNvbnN0IG91dHB1dFBhdGggPSByZXNvbHZlKGFwcFJvb3RbXCJwYXRoXCJdLCBcIi4vLmNvbXBpbGVyL2luZGV4LmpzXCIpO1xuXHRcdGNvbnN0IGNoaWxkUHJvY2VzcyA9IHNwYXduKFwibm9kZVwiLCBbb3V0cHV0UGF0aF0pO1xuXHRcdGxldCByZWFkYWJsZU91dHB1dDogc3RyaW5nW10gPSBbXTtcblxuXHRcdGNoaWxkUHJvY2Vzcy5zdGRvdXQub24oXCJkYXRhXCIsIChkYXRhKSA9PiB7XG5cdFx0XHRpZiAoZGF0YSkge1xuXHRcdFx0XHRjb25zdCB0cmltbWVkRGF0YSA9IGRhdGEudG9TdHJpbmcoKS50cmltKCk7XG5cdFx0XHRcdHJlYWRhYmxlT3V0cHV0LnB1c2goY2hhbGsud2hpdGUodHJpbW1lZERhdGEpKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdGNoaWxkUHJvY2Vzcy5zdGRlcnIub24oXCJkYXRhXCIsIChkYXRhKSA9PiB7XG5cdFx0XHRpZiAoZGF0YSkge1xuXHRcdFx0XHRjb25zdCB0cmltbWVkRGF0YSA9IGRhdGEudG9TdHJpbmcoKS50cmltKCk7XG5cdFx0XHRcdHJlYWRhYmxlT3V0cHV0LnB1c2goY2hhbGsucmVkKHRyaW1tZWREYXRhKSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRjaGlsZFByb2Nlc3Mub24oXCJjbG9zZVwiLCAoY29kZSkgPT4ge1xuXHRcdFx0aWYgKCEhcmVhZGFibGVPdXRwdXRbXCJsZW5ndGhcIl0pIHtcblx0XHRcdFx0cmVhZGFibGVPdXRwdXQgPSBbXG5cdFx0XHRcdFx0Y2hhbGsuZ3JlZW4oXCLinJMgQXBwbGljYXRpb24gcmVuZGVyZWQgdGhlIGZvbGxvd2luZyBMT0dTXCIpLFxuXHRcdFx0XHRcdC4uLnJlYWRhYmxlT3V0cHV0LFxuXHRcdFx0XHRcdGNoYWxrLmdyZWVuKFwi4oalIEFwcGxpY2F0aW9uIExPRyBFTkRcIiksXG5cdFx0XHRcdF07XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZWFkYWJsZU91dHB1dC5wdXNoKGNoYWxrLmdyZWVuKFwi4pyTIEFwcGxpY2F0aW9uIHJlbmRlcmVkIHdpdGhvdXQgTE9HU1wiKSk7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnNvbGUubG9nKHJlYWRhYmxlT3V0cHV0LmpvaW4oXCJcXG5cIikpO1xuXG5cdFx0XHRpZiAoY29kZSA9PT0gMCkge1xuXHRcdFx0XHRfcmVzb2x2ZSgpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0X3JlamVjdChgQ29tcGlsYXRpb24gZmFpbGVkIHdpdGggZXhpdCBjb2RlICR7Y29kZX1gKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSk7XG5cbi8qKlxuICogRXhlY3V0aW9uXG4gKi9cblxuY29uc3Qgc3RhcnQgPSAoKSA9PiB7XG5cdHN0ZXAudHJpZ2dlcihcImNvbXBpbGF0aW9uXCIpO1xuXG5cdGlmIChpc1NlcnZlKSB7XG5cdFx0c3RlcC50cmlnZ2VyKFwic2VydmluZ1wiKTtcblx0XHRzZXJ2ZXIuc3RhcnQoKTtcblx0fSBlbHNlIGlmIChpc0Rldikge1xuXHRcdGNvbXBpbGVyLndhdGNoKHt9LCB3ZWJwYWNrRXJyb3JIYW5kbGVyKTtcblx0fSBlbHNlIHtcblx0XHRjb21waWxlci5ydW4od2VicGFja0Vycm9ySGFuZGxlcik7XG5cdH1cblxuXHRjb21waWxlci5ob29rcy5kb25lLnRhcChcIkRvbmVNZXNzYWdlXCIsIGFzeW5jIChzdGF0cykgPT4ge1xuXHRcdHN0ZXAuc3RvcD8uKCk7XG5cblx0XHRhd2FpdCBydW5Db21waWxlcigpO1xuXG5cdFx0c3RlcC50cmlnZ2VyKFwiYnVuZGxpbmdcIik7XG5cdFx0YnVuZGxlLnJ1bih3ZWJwYWNrRXJyb3JIYW5kbGVyKTtcblxuXHRcdGJ1bmRsZS5ob29rcy5kb25lLnRhcChcIkRvbmVNZXNzYWdlXCIsIGFzeW5jIChzdGF0cykgPT4ge1xuXHRcdFx0c3RlcC5zdG9wPy4oKTtcblxuXHRcdFx0aWYgKGlzRGV2KSB7XG5cdFx0XHRcdHN0ZXAudHJpZ2dlcihcIndhaXRpbmdcIik7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhjaGFsay5ncmVlbihcIuKckyBDb21waWxhdGlvbiBjb21wbGV0ZWQsIHlvdSBhcmUgcmVhZHkgdG8gZ28hXCIpKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSk7XG59O1xuXG5zdGFydCgpO1xuIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJyZXF1aXJlIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsIm4iLCJnZXR0ZXIiLCJfX2VzTW9kdWxlIiwiZCIsImEiLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJ0cmlnZ2VyU3RlcCIsInN0ZXAiLCJzdG9wIiwic3RhcnQiLCJsb2FkaW5nIiwiZ2V0U3RlcE1lc3NhZ2UiLCJjbGVhck9uRW5kIiwic3Bpbm5lciIsImN1cnJlbnQiLCJ0ZXJtaW5hdGVTdGVwIiwidHJpZ2dlciIsInRlcm1pbmF0ZSIsInByb2Nlc3MiLCJhcmd2IiwiY3BTeW5jIiwicmVzb2x2ZSIsImN3ZCIsInJlY3Vyc2l2ZSIsImNoZGlyIiwic3Bhd25TeW5jIiwic3RkaW8iLCJzdGF0dXMiLCJjb25zb2xlIiwibG9nIiwiZXhpdCIsImVycm9yIiwiV1BfSE9TVCIsImVudiIsIkVycm9yIiwiaXNTZXJ2ZSIsImlzRGV2IiwiY29uZmlndXJhdGlvbiIsIm1vZGUiLCJkZXZ0b29sIiwicnVsZXMiLCJ0ZXN0IiwidXNlIiwibG9hZGVyIiwib3B0aW9ucyIsInRyYW5zcGlsZU9ubHkiLCJleGNsdWRlIiwidHlwZSIsImdlbmVyYXRvciIsImZpbGVuYW1lIiwiZXh0ZW5zaW9ucyIsIm1vZHVsZXMiLCJhbGlhcyIsInBsdWdpbnMiLCJUc2NvbmZpZ1BhdGhzUGx1Z2luIiwiY29uZmlnRmlsZSIsIkRlZmluZVBsdWdpbiIsIk1PREUiLCJKU09OIiwic3RyaW5naWZ5IiwiUFJPSkVDVCIsIkNPUkVfV1AiLCJvdXRwdXQiLCJwdWJsaWNQYXRoIiwib3B0aW1pemF0aW9uIiwic3BsaXRDaHVua3MiLCJjYWNoZUdyb3VwcyIsInN0eWxlcyIsIm5hbWUiLCJjaHVua3MiLCJlbmZvcmNlIiwid2VicGFja0Vycm9ySGFuZGxlciIsImVyciIsInN0YXRzIiwiaGFzRXJyb3JzIiwiYnVuZGxlIiwid2VicGFjayIsIm1lcmdlIiwidGFyZ2V0IiwiZW50cnkiLCJtYWluIiwicGF0aCIsImNsZWFuIiwiaW5mcmFzdHJ1Y3R1cmVMb2dnaW5nIiwibGV2ZWwiLCJzZXJ2ZXIiLCJzdGF0aWMiLCJjb21wcmVzcyIsInBvcnQiLCJoaXN0b3J5QXBpRmFsbGJhY2siLCJjb21waWxlciIsImluZGV4Iiwid2F0Y2giLCJydW4iLCJob29rcyIsImRvbmUiLCJ0YXAiLCJhc3luYyIsIlByb21pc2UiLCJfcmVzb2x2ZSIsIl9yZWplY3QiLCJvdXRwdXRQYXRoIiwiY2hpbGRQcm9jZXNzIiwic3Bhd24iLCJyZWFkYWJsZU91dHB1dCIsInN0ZG91dCIsIm9uIiwiZGF0YSIsInRyaW1tZWREYXRhIiwidG9TdHJpbmciLCJ0cmltIiwicHVzaCIsInN0ZGVyciIsImNvZGUiLCJqb2luIl0sInNvdXJjZVJvb3QiOiIifQ==