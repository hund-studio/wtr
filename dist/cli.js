#!/usr/bin/env node

(()=>{"use strict";var e={81:e=>{e.exports=require("child_process")}},t={};function r(s){var o=t[s];if(void 0!==o)return o.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{require("dotenv/config");const e=require("fs"),t=require("cli-loading-animation"),s=require("webpack-merge"),o=require("path");var n=r(81);const i=require("tsconfig-paths-webpack-plugin"),a=require("webpack"),l=require("app-root-path");var c=r.n(l);const p=require("chalk");var u=r.n(p);const d=require("cli-spinners");var g=r.n(d);const m=require("mini-css-extract-plugin");var h=r.n(m);const v=require("webpack-dev-server");var w=r.n(v);const f=e=>{y.stop&&y.stop();const{start:r,stop:s}=(0,t.loading)(u().magenta((e=>{switch(e){case"initialization":return"Setting up boilerplate...";case"configuration":return"Installing required packages...";case"compilation":return"Generating WP compiler...";case"serving":return"Server started...";case"bundling":return"Generating WP assets...";case"waiting":return"Compilation completed, waiting for file changes..."}})(e)),{clearOnEnd:!0,spinner:g().dots});y.current=e,y.start=r,y.stop=s,y.start()},b=()=>{y.stop&&y.stop()},y={current:null,trigger:f,terminate:b};if("init"===process.argv[2]){f("initialization"),(0,e.cpSync)((0,o.resolve)(c().path,"node_modules/@hund-ernesto/wtr/init"),(0,o.resolve)(process.cwd(),"website"),{recursive:!0}),process.chdir((0,o.resolve)(process.cwd(),"website")),f("configuration");const{spawnSync:t}=r(81);0===t("npm",["install"],{stdio:"inherit"}).status?(b(),console.log(u().blue("Initialization completed, you are ready to go!")),process.exit()):(console.error("Error running npm install"),process.exit(1))}const x=process.env.WP_HOST;if(!x)throw new Error("undefined-env-wp_host");const O="start"===process.argv[2],_=O||"dev"===process.argv[2],P={mode:_?"development":"production",devtool:_?"inline-source-map":"source-map",module:{rules:[{test:/\.tsx?$/,use:[{loader:"ts-loader",options:{transpileOnly:!0}}],exclude:/node_modules\/(?!@hund-ernesto\/wtr)/},{test:/\.scss$/,use:[h().loader,"css-loader","sass-loader"]},{test:/\.(png|svg|jpg|jpeg|gif)$/i,type:"asset/resource",generator:{filename:"assets/images/[name][ext]"}},{test:/\.(woff|woff2|eot|ttf|otf)$/i,type:"asset/resource",generator:{filename:"assets/fonts/[name][ext]"}}]},resolve:{extensions:["",".tsx",".ts",".js",".jsx",".css",".scss"],modules:["node_modules"],alias:{"@":c().path},plugins:[new i.TsconfigPathsPlugin({configFile:(0,o.resolve)(c().path,"tsconfig.json"),extensions:[".ts",".js"]})]},plugins:[new a.DefinePlugin({MODE:JSON.stringify(O?"serve":_?"watch":"build"),PROJECT:JSON.stringify(c().path),CORE_WP:JSON.stringify((0,o.resolve)(c().path,"node_modules/@hund-ernesto/wtr")),WP_HOST:JSON.stringify(x)}),new(h())({})],output:{publicPath:"/wp-content/themes/wp-theme/dist/"},optimization:{splitChunks:{cacheGroups:{styles:{name:"main",type:"css/mini-extract",chunks:"all",enforce:!0}}}}},k=(e,t)=>{if(e||t?.hasErrors())return y.terminate(),void console.error(u().red("WP Compiler bundle failed due to an unknown error"))},q=(0,a.webpack)((0,s.merge)(P,{target:"web",entry:{main:(0,o.resolve)(c().path,"node_modules/@hund-ernesto/wtr/src/bundle.tsx")},output:{filename:"[name].js",path:(0,o.resolve)(c().path,"_out/wp-theme/dist"),clean:!0,publicPath:O?"/":void 0},infrastructureLogging:{level:"error"},stats:"none"})),j=new(w())({static:[(0,o.resolve)(c().path,"node_modules/@hund-ernesto/wtr/server"),(0,o.resolve)(c().path,"_out/wp-theme/dist")],compress:!0,port:9e3,historyApiFallback:!0},q),S=(0,a.webpack)((0,s.merge)(P,{target:"node",entry:{index:(0,o.resolve)(c().path,"node_modules/@hund-ernesto/wtr/src/compiler.tsx")},output:{filename:"[name].js",path:(0,o.resolve)(c().path,".compiler"),clean:!0}}));y.trigger("compilation"),O?(y.trigger("serving"),j.start()):_?S.watch({},k):S.run(k),S.hooks.done.tap("DoneMessage",(async e=>{y.stop?.(),await new Promise(((e,t)=>{console.log(u().magenta("=== Compilation LOG ===")),console.log(u().magenta());const r=(0,o.resolve)(c().path,"./.compiler/index.js"),s=(0,n.spawn)("node",[r]);s.stdout.on("data",(e=>{console.log(u().white(e))})),s.stderr.on("data",(e=>{console.error(u().red(e))})),s.on("close",(r=>{console.log(u().magenta()),console.log(u().magenta("=== LOG END ===")),console.log(u().magenta()),0===r?e():t(`Compilation failed with exit code ${r}`)}))})),y.trigger("bundling"),q.run(k),q.hooks.done.tap("DoneMessage",(async e=>{y.stop?.(),_?y.trigger("waiting"):console.log(u().blue("Compilation completed, you are ready to go!"))}))}))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxHQUFHLFFBQVNDLElBQy9COUUsUUFBUUMsSUFBSSxVQUFZNkUsR0FBTSxJQUcvQkosRUFBYUssT0FBT0YsR0FBRyxRQUFTQyxJQUMvQjlFLFFBQVFHLE1BQU0sUUFBVTJFLEdBQU0sSUFHL0JKLEVBQWFHLEdBQUcsU0FBVUcsSUFDekJoRixRQUFRQyxJQUFJLGVBQ1pELFFBQVFDLElBQUksWUFBYyxvQkFDMUJELFFBQVFDLElBQUksZUFFQyxJQUFUK0UsRUFDSFQsSUFFQUMsRUFBUSxxQ0FBcUNRLElBQzlDLEdBQ0MsSUF3QkZyRyxFQUFLUyxRQUFRLFlBQ2IyRCxFQUFPa0IsSUFBSXRCLEdBRVhJLEVBQU9tQixNQUFNQyxLQUFLQyxJQUFJLGVBQWVDLE1BQU94QixJQUMzQ2xFLEVBQUtDLFNBRUQ0QixFQUNIN0IsRUFBS1MsUUFBUSxXQUViWSxRQUFRQyxJQUFJLFNBQVcsK0NBQ3hCLEdBQ0MsRyIsInNvdXJjZXMiOlsid2VicGFjazovL0BodW5kLWVybmVzdG8vd3RyL2V4dGVybmFsIG5vZGUtY29tbW9uanMgXCJjaGlsZF9wcm9jZXNzXCIiLCJ3ZWJwYWNrOi8vQGh1bmQtZXJuZXN0by93dHIvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vQGh1bmQtZXJuZXN0by93dHIvd2VicGFjay9ydW50aW1lL2NvbXBhdCBnZXQgZGVmYXVsdCBleHBvcnQiLCJ3ZWJwYWNrOi8vQGh1bmQtZXJuZXN0by93dHIvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL0BodW5kLWVybmVzdG8vd3RyL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vQGh1bmQtZXJuZXN0by93dHIvZXh0ZXJuYWwgY29tbW9uanMgXCJkb3RlbnYvY29uZmlnXCIiLCJ3ZWJwYWNrOi8vQGh1bmQtZXJuZXN0by93dHIvZXh0ZXJuYWwgbm9kZS1jb21tb25qcyBcImZzXCIiLCJ3ZWJwYWNrOi8vQGh1bmQtZXJuZXN0by93dHIvZXh0ZXJuYWwgY29tbW9uanMgXCJjbGktbG9hZGluZy1hbmltYXRpb25cIiIsIndlYnBhY2s6Ly9AaHVuZC1lcm5lc3RvL3d0ci9leHRlcm5hbCBjb21tb25qcyBcIndlYnBhY2stbWVyZ2VcIiIsIndlYnBhY2s6Ly9AaHVuZC1lcm5lc3RvL3d0ci9leHRlcm5hbCBub2RlLWNvbW1vbmpzIFwicGF0aFwiIiwid2VicGFjazovL0BodW5kLWVybmVzdG8vd3RyL2V4dGVybmFsIGNvbW1vbmpzIFwidHNjb25maWctcGF0aHMtd2VicGFjay1wbHVnaW5cIiIsIndlYnBhY2s6Ly9AaHVuZC1lcm5lc3RvL3d0ci9leHRlcm5hbCBjb21tb25qcyBcIndlYnBhY2tcIiIsIndlYnBhY2s6Ly9AaHVuZC1lcm5lc3RvL3d0ci9leHRlcm5hbCBjb21tb25qcyBcImFwcC1yb290LXBhdGhcIiIsIndlYnBhY2s6Ly9AaHVuZC1lcm5lc3RvL3d0ci9leHRlcm5hbCBjb21tb25qcyBcImNoYWxrXCIiLCJ3ZWJwYWNrOi8vQGh1bmQtZXJuZXN0by93dHIvZXh0ZXJuYWwgY29tbW9uanMgXCJjbGktc3Bpbm5lcnNcIiIsIndlYnBhY2s6Ly9AaHVuZC1lcm5lc3RvL3d0ci9leHRlcm5hbCBjb21tb25qcyBcIm1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXCIiLCJ3ZWJwYWNrOi8vQGh1bmQtZXJuZXN0by93dHIvZXh0ZXJuYWwgY29tbW9uanMgXCJ3ZWJwYWNrLWRldi1zZXJ2ZXJcIiIsIndlYnBhY2s6Ly9AaHVuZC1lcm5lc3RvL3d0ci8uL3NyYy9jbGkudHMiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiY2hpbGRfcHJvY2Vzc1wiKTsiLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbl9fd2VicGFja19yZXF1aXJlX18ubiA9IChtb2R1bGUpID0+IHtcblx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG5cdFx0KCkgPT4gKG1vZHVsZVsnZGVmYXVsdCddKSA6XG5cdFx0KCkgPT4gKG1vZHVsZSk7XG5cdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsIHsgYTogZ2V0dGVyIH0pO1xuXHRyZXR1cm4gZ2V0dGVyO1xufTsiLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IHJlcXVpcmUoXCJkb3RlbnYvY29uZmlnXCIpOyIsImNvbnN0IF9fV0VCUEFDS19OQU1FU1BBQ0VfT0JKRUNUX18gPSByZXF1aXJlKFwiZnNcIik7IiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IHJlcXVpcmUoXCJjbGktbG9hZGluZy1hbmltYXRpb25cIik7IiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IHJlcXVpcmUoXCJ3ZWJwYWNrLW1lcmdlXCIpOyIsImNvbnN0IF9fV0VCUEFDS19OQU1FU1BBQ0VfT0JKRUNUX18gPSByZXF1aXJlKFwicGF0aFwiKTsiLCJjb25zdCBfX1dFQlBBQ0tfTkFNRVNQQUNFX09CSkVDVF9fID0gcmVxdWlyZShcInRzY29uZmlnLXBhdGhzLXdlYnBhY2stcGx1Z2luXCIpOyIsImNvbnN0IF9fV0VCUEFDS19OQU1FU1BBQ0VfT0JKRUNUX18gPSByZXF1aXJlKFwid2VicGFja1wiKTsiLCJjb25zdCBfX1dFQlBBQ0tfTkFNRVNQQUNFX09CSkVDVF9fID0gcmVxdWlyZShcImFwcC1yb290LXBhdGhcIik7IiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IHJlcXVpcmUoXCJjaGFsa1wiKTsiLCJjb25zdCBfX1dFQlBBQ0tfTkFNRVNQQUNFX09CSkVDVF9fID0gcmVxdWlyZShcImNsaS1zcGlubmVyc1wiKTsiLCJjb25zdCBfX1dFQlBBQ0tfTkFNRVNQQUNFX09CSkVDVF9fID0gcmVxdWlyZShcIm1pbmktY3NzLWV4dHJhY3QtcGx1Z2luXCIpOyIsImNvbnN0IF9fV0VCUEFDS19OQU1FU1BBQ0VfT0JKRUNUX18gPSByZXF1aXJlKFwid2VicGFjay1kZXYtc2VydmVyXCIpOyIsImltcG9ydCBcImRvdGVudi9jb25maWdcIjtcbmltcG9ydCB7IGNwU3luYyB9IGZyb20gXCJmc1wiO1xuaW1wb3J0IHsgTG9hZGVyQWN0aW9ucywgbG9hZGluZyB9IGZyb20gXCJjbGktbG9hZGluZy1hbmltYXRpb25cIjtcbmltcG9ydCB7IG1lcmdlIH0gZnJvbSBcIndlYnBhY2stbWVyZ2VcIjtcbmltcG9ydCB7IHJlc29sdmUgfSBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IHsgc3Bhd24gfSBmcm9tIFwiY2hpbGRfcHJvY2Vzc1wiO1xuaW1wb3J0IHsgVHNjb25maWdQYXRoc1BsdWdpbiB9IGZyb20gXCJ0c2NvbmZpZy1wYXRocy13ZWJwYWNrLXBsdWdpblwiO1xuaW1wb3J0IHsgd2VicGFjaywgRGVmaW5lUGx1Z2luLCBDb25maWd1cmF0aW9uLCBTdGF0cyB9IGZyb20gXCJ3ZWJwYWNrXCI7XG5pbXBvcnQgYXBwUm9vdCBmcm9tIFwiYXBwLXJvb3QtcGF0aFwiO1xuaW1wb3J0IGNoYWxrIGZyb20gXCJjaGFsa1wiO1xuaW1wb3J0IGNsaVNwaW5uZXJzIGZyb20gXCJjbGktc3Bpbm5lcnNcIjtcbmltcG9ydCBNaW5pQ3NzRXh0cmFjdFBsdWdpbiBmcm9tIFwibWluaS1jc3MtZXh0cmFjdC1wbHVnaW5cIjtcbmltcG9ydCBXZWJwYWNrRGV2U2VydmVyIGZyb20gXCJ3ZWJwYWNrLWRldi1zZXJ2ZXJcIjtcbmltcG9ydCBcIndlYnBhY2stZGV2LXNlcnZlclwiO1xuXG4vKipcbiAqIEhhbmRsZSBDTEkgc3RlcHMgdmlzdWFsaXphdGlvblxuICovXG5cbmludGVyZmFjZSBJU3RlcCBleHRlbmRzIFBhcnRpYWw8TG9hZGVyQWN0aW9ucz4ge1xuXHRjdXJyZW50OiBzdHJpbmcgfCBudWxsO1xuXHR0cmlnZ2VyOiB0eXBlb2YgdHJpZ2dlclN0ZXA7XG5cdHRlcm1pbmF0ZTogdHlwZW9mIHRlcm1pbmF0ZVN0ZXA7XG59XG5cbnR5cGUgU3RlcEtleSA9XG5cdHwgXCJjb25maWd1cmF0aW9uXCJcblx0fCBcImluaXRpYWxpemF0aW9uXCJcblx0fCBcImNvbXBpbGF0aW9uXCJcblx0fCBcImJ1bmRsaW5nXCJcblx0fCBcIndhaXRpbmdcIlxuXHR8IFwic2VydmluZ1wiO1xuXG5jb25zdCBnZXRTdGVwTWVzc2FnZSA9IChrZXk6IFN0ZXBLZXkpID0+IHtcblx0c3dpdGNoIChrZXkpIHtcblx0XHRjYXNlIFwiaW5pdGlhbGl6YXRpb25cIjpcblx0XHRcdHJldHVybiBcIlNldHRpbmcgdXAgYm9pbGVycGxhdGUuLi5cIjtcblx0XHRjYXNlIFwiY29uZmlndXJhdGlvblwiOlxuXHRcdFx0cmV0dXJuIFwiSW5zdGFsbGluZyByZXF1aXJlZCBwYWNrYWdlcy4uLlwiO1xuXHRcdGNhc2UgXCJjb21waWxhdGlvblwiOlxuXHRcdFx0cmV0dXJuIFwiR2VuZXJhdGluZyBXUCBjb21waWxlci4uLlwiO1xuXHRcdGNhc2UgXCJzZXJ2aW5nXCI6XG5cdFx0XHRyZXR1cm4gXCJTZXJ2ZXIgc3RhcnRlZC4uLlwiO1xuXHRcdGNhc2UgXCJidW5kbGluZ1wiOlxuXHRcdFx0cmV0dXJuIFwiR2VuZXJhdGluZyBXUCBhc3NldHMuLi5cIjtcblx0XHRjYXNlIFwid2FpdGluZ1wiOlxuXHRcdFx0cmV0dXJuIFwiQ29tcGlsYXRpb24gY29tcGxldGVkLCB3YWl0aW5nIGZvciBmaWxlIGNoYW5nZXMuLi5cIjtcblx0fVxufTtcblxuY29uc3QgdHJpZ2dlclN0ZXAgPSAoa2V5OiBTdGVwS2V5KSA9PiB7XG5cdGlmICghIXN0ZXBbXCJzdG9wXCJdKSB7XG5cdFx0c3RlcC5zdG9wKCk7XG5cdH1cblxuXHRjb25zdCB7IHN0YXJ0LCBzdG9wIH0gPSBsb2FkaW5nKGNoYWxrLm1hZ2VudGEoZ2V0U3RlcE1lc3NhZ2Uoa2V5KSksIHtcblx0XHRjbGVhck9uRW5kOiB0cnVlLFxuXHRcdHNwaW5uZXI6IGNsaVNwaW5uZXJzW1wiZG90c1wiXSxcblx0fSk7XG5cdHN0ZXAuY3VycmVudCA9IGtleTtcblx0c3RlcC5zdGFydCA9IHN0YXJ0O1xuXHRzdGVwLnN0b3AgPSBzdG9wO1xuXG5cdHN0ZXAuc3RhcnQoKTtcbn07XG5cbmNvbnN0IHRlcm1pbmF0ZVN0ZXAgPSAoKSA9PiB7XG5cdGlmICghIXN0ZXBbXCJzdG9wXCJdKSB7XG5cdFx0c3RlcC5zdG9wKCk7XG5cdH1cbn07XG5cbmNvbnN0IHN0ZXA6IElTdGVwID0ge1xuXHRjdXJyZW50OiBudWxsLFxuXHR0cmlnZ2VyOiB0cmlnZ2VyU3RlcCxcblx0dGVybWluYXRlOiB0ZXJtaW5hdGVTdGVwLFxufTtcblxuLyoqXG4gKiBJbml0aWFsaXphdGlvbiBzY3JpcHRcbiAqL1xuXG5jb25zdCBpc0luaXQgPSBwcm9jZXNzLmFyZ3ZbMl0gPT09IFwiaW5pdFwiO1xuXG5pZiAoaXNJbml0KSB7XG5cdHRyaWdnZXJTdGVwKFwiaW5pdGlhbGl6YXRpb25cIik7XG5cblx0Y3BTeW5jKFxuXHRcdHJlc29sdmUoYXBwUm9vdFtcInBhdGhcIl0sIFwibm9kZV9tb2R1bGVzL0BodW5kLWVybmVzdG8vd3RyL2luaXRcIiksXG5cdFx0cmVzb2x2ZShwcm9jZXNzLmN3ZCgpLCBcIndlYnNpdGVcIiksXG5cdFx0e1xuXHRcdFx0cmVjdXJzaXZlOiB0cnVlLFxuXHRcdH1cblx0KTtcblxuXHRwcm9jZXNzLmNoZGlyKHJlc29sdmUocHJvY2Vzcy5jd2QoKSwgXCJ3ZWJzaXRlXCIpKTtcblxuXHR0cmlnZ2VyU3RlcChcImNvbmZpZ3VyYXRpb25cIik7XG5cdGNvbnN0IHsgc3Bhd25TeW5jIH0gPSByZXF1aXJlKFwiY2hpbGRfcHJvY2Vzc1wiKTtcblx0Y29uc3QgbnBtSW5zdGFsbCA9IHNwYXduU3luYyhcIm5wbVwiLCBbXCJpbnN0YWxsXCJdLCB7IHN0ZGlvOiBcImluaGVyaXRcIiB9KTtcblxuXHRpZiAobnBtSW5zdGFsbC5zdGF0dXMgPT09IDApIHtcblx0XHR0ZXJtaW5hdGVTdGVwKCk7XG5cdFx0Y29uc29sZS5sb2coY2hhbGsuYmx1ZShcIkluaXRpYWxpemF0aW9uIGNvbXBsZXRlZCwgeW91IGFyZSByZWFkeSB0byBnbyFcIikpO1xuXHRcdHByb2Nlc3MuZXhpdCgpO1xuXHR9IGVsc2Uge1xuXHRcdGNvbnNvbGUuZXJyb3IoXCJFcnJvciBydW5uaW5nIG5wbSBpbnN0YWxsXCIpO1xuXHRcdHByb2Nlc3MuZXhpdCgxKTtcblx0fVxufVxuXG4vKipcbiAqIE9wdGlvbnNcbiAqL1xuXG5jb25zdCBXUF9IT1NUID0gcHJvY2Vzcy5lbnYuV1BfSE9TVDtcblxuaWYgKCFXUF9IT1NUKSB7XG5cdHRocm93IG5ldyBFcnJvcihcInVuZGVmaW5lZC1lbnYtd3BfaG9zdFwiKTsgLy8gVE9ETyBFcnJvciBkaXNwbGF5XG59XG5cbmNvbnN0IGlzU2VydmUgPSBwcm9jZXNzLmFyZ3ZbMl0gPT09IFwic3RhcnRcIjtcbmNvbnN0IGlzRGV2ID0gaXNTZXJ2ZSB8fCBwcm9jZXNzLmFyZ3ZbMl0gPT09IFwiZGV2XCI7XG5cbi8qKlxuICogV2VicGFjayBnbG9iYWwgY29uZmlndXJhdGlvblxuICovXG5jb25zdCBjb25maWd1cmF0aW9uOiBDb25maWd1cmF0aW9uID0ge1xuXHRtb2RlOiBpc0RldiA/IFwiZGV2ZWxvcG1lbnRcIiA6IFwicHJvZHVjdGlvblwiLFxuXHRkZXZ0b29sOiBpc0RldiA/IFwiaW5saW5lLXNvdXJjZS1tYXBcIiA6IFwic291cmNlLW1hcFwiLFxuXHRtb2R1bGU6IHtcblx0XHRydWxlczogW1xuXHRcdFx0e1xuXHRcdFx0XHR0ZXN0OiAvXFwudHN4PyQvLFxuXHRcdFx0XHR1c2U6IFtcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRsb2FkZXI6IFwidHMtbG9hZGVyXCIsXG5cdFx0XHRcdFx0XHRvcHRpb25zOiB7XG5cdFx0XHRcdFx0XHRcdHRyYW5zcGlsZU9ubHk6IHRydWUsXG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdF0sXG5cdFx0XHRcdGV4Y2x1ZGU6IC9ub2RlX21vZHVsZXNcXC8oPyFAaHVuZC1lcm5lc3RvXFwvd3RyKS8sXG5cdFx0XHR9LFxuXHRcdFx0e1xuXHRcdFx0XHR0ZXN0OiAvXFwuc2NzcyQvLFxuXHRcdFx0XHR1c2U6IFtNaW5pQ3NzRXh0cmFjdFBsdWdpbi5sb2FkZXIsIFwiY3NzLWxvYWRlclwiLCBcInNhc3MtbG9hZGVyXCJdLFxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0dGVzdDogL1xcLihwbmd8c3ZnfGpwZ3xqcGVnfGdpZikkL2ksXG5cdFx0XHRcdHR5cGU6IFwiYXNzZXQvcmVzb3VyY2VcIixcblx0XHRcdFx0Z2VuZXJhdG9yOiB7XG5cdFx0XHRcdFx0ZmlsZW5hbWU6IFwiYXNzZXRzL2ltYWdlcy9bbmFtZV1bZXh0XVwiLFxuXHRcdFx0XHR9LFxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0dGVzdDogL1xcLih3b2ZmfHdvZmYyfGVvdHx0dGZ8b3RmKSQvaSxcblx0XHRcdFx0dHlwZTogXCJhc3NldC9yZXNvdXJjZVwiLFxuXHRcdFx0XHRnZW5lcmF0b3I6IHtcblx0XHRcdFx0XHRmaWxlbmFtZTogXCJhc3NldHMvZm9udHMvW25hbWVdW2V4dF1cIixcblx0XHRcdFx0fSxcblx0XHRcdH0sXG5cdFx0XSxcblx0fSxcblx0cmVzb2x2ZToge1xuXHRcdGV4dGVuc2lvbnM6IFtcIlwiLCBcIi50c3hcIiwgXCIudHNcIiwgXCIuanNcIiwgXCIuanN4XCIsIFwiLmNzc1wiLCBcIi5zY3NzXCJdLFxuXHRcdG1vZHVsZXM6IFtcIm5vZGVfbW9kdWxlc1wiXSxcblx0XHRhbGlhczoge1xuXHRcdFx0XCJAXCI6IGFwcFJvb3RbXCJwYXRoXCJdLFxuXHRcdH0sXG5cdFx0cGx1Z2luczogW1xuXHRcdFx0bmV3IFRzY29uZmlnUGF0aHNQbHVnaW4oe1xuXHRcdFx0XHRjb25maWdGaWxlOiByZXNvbHZlKGFwcFJvb3RbXCJwYXRoXCJdLCBcInRzY29uZmlnLmpzb25cIiksXG5cdFx0XHRcdGV4dGVuc2lvbnM6IFtcIi50c1wiLCBcIi5qc1wiXSxcblx0XHRcdH0pLFxuXHRcdF0sIC8vIFRPRE8gZXZhbHVhdGUgaWYgbmVlZGVkXG5cdH0sXG5cdHBsdWdpbnM6IFtcblx0XHRuZXcgRGVmaW5lUGx1Z2luKHtcblx0XHRcdE1PREU6IEpTT04uc3RyaW5naWZ5KGlzU2VydmUgPyBcInNlcnZlXCIgOiBpc0RldiA/IFwid2F0Y2hcIiA6IFwiYnVpbGRcIiksXG5cdFx0XHRQUk9KRUNUOiBKU09OLnN0cmluZ2lmeShhcHBSb290W1wicGF0aFwiXSksXG5cdFx0XHRDT1JFX1dQOiBKU09OLnN0cmluZ2lmeShyZXNvbHZlKGFwcFJvb3RbXCJwYXRoXCJdLCBcIm5vZGVfbW9kdWxlcy9AaHVuZC1lcm5lc3RvL3d0clwiKSksXG5cdFx0XHRXUF9IT1NUOiBKU09OLnN0cmluZ2lmeShXUF9IT1NUKSxcblx0XHR9KSxcblx0XHRuZXcgTWluaUNzc0V4dHJhY3RQbHVnaW4oe30pLFxuXHRdLFxuXHRvdXRwdXQ6IHtcblx0XHRwdWJsaWNQYXRoOiBcIi93cC1jb250ZW50L3RoZW1lcy93cC10aGVtZS9kaXN0L1wiLFxuXHR9LFxuXHRvcHRpbWl6YXRpb246IHtcblx0XHRzcGxpdENodW5rczoge1xuXHRcdFx0Y2FjaGVHcm91cHM6IHtcblx0XHRcdFx0c3R5bGVzOiB7XG5cdFx0XHRcdFx0bmFtZTogXCJtYWluXCIsXG5cdFx0XHRcdFx0dHlwZTogXCJjc3MvbWluaS1leHRyYWN0XCIsXG5cdFx0XHRcdFx0Y2h1bmtzOiBcImFsbFwiLFxuXHRcdFx0XHRcdGVuZm9yY2U6IHRydWUsXG5cdFx0XHRcdH0sXG5cdFx0XHR9LFxuXHRcdH0sXG5cdH0sXG59O1xuXG5jb25zdCB3ZWJwYWNrRXJyb3JIYW5kbGVyID0gKGVycjogRXJyb3IgfCBudWxsIHwgdW5kZWZpbmVkLCBzdGF0czogU3RhdHMgfCB1bmRlZmluZWQpID0+IHtcblx0aWYgKGVyciB8fCBzdGF0cz8uaGFzRXJyb3JzKCkpIHtcblx0XHRzdGVwLnRlcm1pbmF0ZSgpO1xuXHRcdGNvbnNvbGUuZXJyb3IoY2hhbGsucmVkKFwiV1AgQ29tcGlsZXIgYnVuZGxlIGZhaWxlZCBkdWUgdG8gYW4gdW5rbm93biBlcnJvclwiKSk7XG5cdFx0cmV0dXJuO1xuXHR9XG59O1xuXG4vKipcbiAqIFdlYnBhY2sgYnVuZGxlIGdlbmVyYXRvclxuICovXG5cbmNvbnN0IGJ1bmRsZSA9IHdlYnBhY2soXG5cdG1lcmdlKGNvbmZpZ3VyYXRpb24sIHtcblx0XHR0YXJnZXQ6IFwid2ViXCIsXG5cdFx0ZW50cnk6IHsgbWFpbjogcmVzb2x2ZShhcHBSb290W1wicGF0aFwiXSwgXCJub2RlX21vZHVsZXMvQGh1bmQtZXJuZXN0by93dHIvc3JjL2J1bmRsZS50c3hcIikgfSxcblx0XHRvdXRwdXQ6IHtcblx0XHRcdGZpbGVuYW1lOiBcIltuYW1lXS5qc1wiLFxuXHRcdFx0cGF0aDogcmVzb2x2ZShhcHBSb290W1wicGF0aFwiXSwgXCJfb3V0L3dwLXRoZW1lL2Rpc3RcIiksXG5cdFx0XHRjbGVhbjogdHJ1ZSxcblx0XHRcdHB1YmxpY1BhdGg6IGlzU2VydmUgPyBcIi9cIiA6IHVuZGVmaW5lZCxcblx0XHR9LFxuXHRcdGluZnJhc3RydWN0dXJlTG9nZ2luZzogeyBsZXZlbDogXCJlcnJvclwiIH0sXG5cdFx0c3RhdHM6IFwibm9uZVwiLFxuXHR9KVxuKTtcblxuLyoqXG4gKiBXZWJwYWNrIHNlcnZlclxuICovXG5cbmNvbnN0IHNlcnZlciA9IG5ldyBXZWJwYWNrRGV2U2VydmVyKFxuXHR7XG5cdFx0c3RhdGljOiBbXG5cdFx0XHRyZXNvbHZlKGFwcFJvb3RbXCJwYXRoXCJdLCBcIm5vZGVfbW9kdWxlcy9AaHVuZC1lcm5lc3RvL3d0ci9zZXJ2ZXJcIiksXG5cdFx0XHRyZXNvbHZlKGFwcFJvb3RbXCJwYXRoXCJdLCBcIl9vdXQvd3AtdGhlbWUvZGlzdFwiKSxcblx0XHRdLFxuXHRcdGNvbXByZXNzOiB0cnVlLFxuXHRcdHBvcnQ6IDkwMDAsXG5cdFx0aGlzdG9yeUFwaUZhbGxiYWNrOiB0cnVlLFxuXHR9LFxuXHRidW5kbGVcbik7XG5cbi8qKlxuICogV2VicGFjayBjb21waWxlciBnZW5lcmF0b3JcbiAqL1xuXG5jb25zdCBjb21waWxlciA9IHdlYnBhY2soXG5cdG1lcmdlKGNvbmZpZ3VyYXRpb24sIHtcblx0XHR0YXJnZXQ6IFwibm9kZVwiLFxuXHRcdGVudHJ5OiB7XG5cdFx0XHRpbmRleDogcmVzb2x2ZShhcHBSb290W1wicGF0aFwiXSwgXCJub2RlX21vZHVsZXMvQGh1bmQtZXJuZXN0by93dHIvc3JjL2NvbXBpbGVyLnRzeFwiKSxcblx0XHR9LFxuXHRcdG91dHB1dDoge1xuXHRcdFx0ZmlsZW5hbWU6IFwiW25hbWVdLmpzXCIsXG5cdFx0XHRwYXRoOiByZXNvbHZlKGFwcFJvb3RbXCJwYXRoXCJdLCBcIi5jb21waWxlclwiKSxcblx0XHRcdGNsZWFuOiB0cnVlLFxuXHRcdH0sXG5cdH0pXG4pO1xuXG5jb25zdCBydW5Db21waWxlciA9ICgpID0+XG5cdG5ldyBQcm9taXNlPHZvaWQ+KChfcmVzb2x2ZSwgX3JlamVjdCkgPT4ge1xuXHRcdGNvbnNvbGUubG9nKGNoYWxrLm1hZ2VudGEoXCI9PT0gQ29tcGlsYXRpb24gTE9HID09PVwiKSk7XG5cdFx0Y29uc29sZS5sb2coY2hhbGsubWFnZW50YSgpKTtcblxuXHRcdGNvbnN0IG91dHB1dFBhdGggPSByZXNvbHZlKGFwcFJvb3RbXCJwYXRoXCJdLCBcIi4vLmNvbXBpbGVyL2luZGV4LmpzXCIpO1xuXHRcdGNvbnN0IGNoaWxkUHJvY2VzcyA9IHNwYXduKFwibm9kZVwiLCBbb3V0cHV0UGF0aF0pO1xuXG5cdFx0Y2hpbGRQcm9jZXNzLnN0ZG91dC5vbihcImRhdGFcIiwgKGRhdGEpID0+IHtcblx0XHRcdGNvbnNvbGUubG9nKGNoYWxrLndoaXRlKGRhdGEpKTtcblx0XHR9KTtcblxuXHRcdGNoaWxkUHJvY2Vzcy5zdGRlcnIub24oXCJkYXRhXCIsIChkYXRhKSA9PiB7XG5cdFx0XHRjb25zb2xlLmVycm9yKGNoYWxrLnJlZChkYXRhKSk7XG5cdFx0fSk7XG5cblx0XHRjaGlsZFByb2Nlc3Mub24oXCJjbG9zZVwiLCAoY29kZSkgPT4ge1xuXHRcdFx0Y29uc29sZS5sb2coY2hhbGsubWFnZW50YSgpKTtcblx0XHRcdGNvbnNvbGUubG9nKGNoYWxrLm1hZ2VudGEoXCI9PT0gTE9HIEVORCA9PT1cIikpO1xuXHRcdFx0Y29uc29sZS5sb2coY2hhbGsubWFnZW50YSgpKTtcblxuXHRcdFx0aWYgKGNvZGUgPT09IDApIHtcblx0XHRcdFx0X3Jlc29sdmUoKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdF9yZWplY3QoYENvbXBpbGF0aW9uIGZhaWxlZCB3aXRoIGV4aXQgY29kZSAke2NvZGV9YCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0pO1xuXG4vKipcbiAqIEV4ZWN1dGlvblxuICovXG5cbmNvbnN0IHN0YXJ0ID0gKCkgPT4ge1xuXHRzdGVwLnRyaWdnZXIoXCJjb21waWxhdGlvblwiKTtcblxuXHRpZiAoaXNTZXJ2ZSkge1xuXHRcdHN0ZXAudHJpZ2dlcihcInNlcnZpbmdcIik7XG5cdFx0c2VydmVyLnN0YXJ0KCk7XG5cdH0gZWxzZSBpZiAoaXNEZXYpIHtcblx0XHRjb21waWxlci53YXRjaCh7fSwgd2VicGFja0Vycm9ySGFuZGxlcik7XG5cdH0gZWxzZSB7XG5cdFx0Y29tcGlsZXIucnVuKHdlYnBhY2tFcnJvckhhbmRsZXIpO1xuXHR9XG5cblx0Y29tcGlsZXIuaG9va3MuZG9uZS50YXAoXCJEb25lTWVzc2FnZVwiLCBhc3luYyAoc3RhdHMpID0+IHtcblx0XHRzdGVwLnN0b3A/LigpO1xuXG5cdFx0YXdhaXQgcnVuQ29tcGlsZXIoKTtcblxuXHRcdHN0ZXAudHJpZ2dlcihcImJ1bmRsaW5nXCIpO1xuXHRcdGJ1bmRsZS5ydW4od2VicGFja0Vycm9ySGFuZGxlcik7XG5cblx0XHRidW5kbGUuaG9va3MuZG9uZS50YXAoXCJEb25lTWVzc2FnZVwiLCBhc3luYyAoc3RhdHMpID0+IHtcblx0XHRcdHN0ZXAuc3RvcD8uKCk7XG5cblx0XHRcdGlmIChpc0Rldikge1xuXHRcdFx0XHRzdGVwLnRyaWdnZXIoXCJ3YWl0aW5nXCIpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc29sZS5sb2coY2hhbGsuYmx1ZShcIkNvbXBpbGF0aW9uIGNvbXBsZXRlZCwgeW91IGFyZSByZWFkeSB0byBnbyFcIikpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9KTtcbn07XG5cbnN0YXJ0KCk7XG4iXSwibmFtZXMiOlsibW9kdWxlIiwiZXhwb3J0cyIsInJlcXVpcmUiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwibiIsImdldHRlciIsIl9fZXNNb2R1bGUiLCJkIiwiYSIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInRyaWdnZXJTdGVwIiwic3RlcCIsInN0b3AiLCJzdGFydCIsImxvYWRpbmciLCJnZXRTdGVwTWVzc2FnZSIsImNsZWFyT25FbmQiLCJzcGlubmVyIiwiY3VycmVudCIsInRlcm1pbmF0ZVN0ZXAiLCJ0cmlnZ2VyIiwidGVybWluYXRlIiwicHJvY2VzcyIsImFyZ3YiLCJjcFN5bmMiLCJyZXNvbHZlIiwiY3dkIiwicmVjdXJzaXZlIiwiY2hkaXIiLCJzcGF3blN5bmMiLCJzdGRpbyIsInN0YXR1cyIsImNvbnNvbGUiLCJsb2ciLCJleGl0IiwiZXJyb3IiLCJXUF9IT1NUIiwiZW52IiwiRXJyb3IiLCJpc1NlcnZlIiwiaXNEZXYiLCJjb25maWd1cmF0aW9uIiwibW9kZSIsImRldnRvb2wiLCJydWxlcyIsInRlc3QiLCJ1c2UiLCJsb2FkZXIiLCJvcHRpb25zIiwidHJhbnNwaWxlT25seSIsImV4Y2x1ZGUiLCJ0eXBlIiwiZ2VuZXJhdG9yIiwiZmlsZW5hbWUiLCJleHRlbnNpb25zIiwibW9kdWxlcyIsImFsaWFzIiwicGx1Z2lucyIsIlRzY29uZmlnUGF0aHNQbHVnaW4iLCJjb25maWdGaWxlIiwiRGVmaW5lUGx1Z2luIiwiTU9ERSIsIkpTT04iLCJzdHJpbmdpZnkiLCJQUk9KRUNUIiwiQ09SRV9XUCIsIm91dHB1dCIsInB1YmxpY1BhdGgiLCJvcHRpbWl6YXRpb24iLCJzcGxpdENodW5rcyIsImNhY2hlR3JvdXBzIiwic3R5bGVzIiwibmFtZSIsImNodW5rcyIsImVuZm9yY2UiLCJ3ZWJwYWNrRXJyb3JIYW5kbGVyIiwiZXJyIiwic3RhdHMiLCJoYXNFcnJvcnMiLCJidW5kbGUiLCJ3ZWJwYWNrIiwibWVyZ2UiLCJ0YXJnZXQiLCJlbnRyeSIsIm1haW4iLCJwYXRoIiwiY2xlYW4iLCJpbmZyYXN0cnVjdHVyZUxvZ2dpbmciLCJsZXZlbCIsInNlcnZlciIsInN0YXRpYyIsImNvbXByZXNzIiwicG9ydCIsImhpc3RvcnlBcGlGYWxsYmFjayIsImNvbXBpbGVyIiwiaW5kZXgiLCJ3YXRjaCIsInJ1biIsImhvb2tzIiwiZG9uZSIsInRhcCIsImFzeW5jIiwiUHJvbWlzZSIsIl9yZXNvbHZlIiwiX3JlamVjdCIsIm91dHB1dFBhdGgiLCJjaGlsZFByb2Nlc3MiLCJzcGF3biIsInN0ZG91dCIsIm9uIiwiZGF0YSIsInN0ZGVyciIsImNvZGUiXSwic291cmNlUm9vdCI6IiJ9